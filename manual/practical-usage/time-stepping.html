
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding adaptive time-stepping &#8212; PISM, a Parallel Ice Sheet Model 1.2 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Balancing the books" href="mass-conservation.html" />
    <link rel="prev" title="Signals, to control a running PISM model" href="signals.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
<div class="documentwrapper">
  <div class="bodywrapper">
    <div class="body" role="main">
      
  <div class="section" id="understanding-adaptive-time-stepping">
<span id="sec-adapt"></span><h1>Understanding adaptive time-stepping<a class="headerlink" href="#understanding-adaptive-time-stepping" title="Permalink to this headline">¶</a></h1>
<p>At each time step the PISM standard output includes “flags” and then a summary of the
model state using a few numbers. A typical example is</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>v$Eh  diffusivity (dt=0.83945 in 2 substeps; av dt_sub_mass_cont=0.41972)
S -124791.571:  3.11640   2.25720      3.62041    18099.93737
y  SSA:     3 outer iterations, ~17.0 KSP iterations each
</pre></div>
</div>
<p>The characters “<code class="docutils literal notranslate"><span class="pre">v$Eh</span></code>” at the beginning of the flags line, the first line in the above
example, give a very terse description of which physical processes were modeled in that
time step. Here “<code class="docutils literal notranslate"><span class="pre">v</span></code>” means that a stress balance was solved to compute the velocity.
Then the enthalpy was updated (“<code class="docutils literal notranslate"><span class="pre">E</span></code>”) and the ice thickness and surface elevation were
updated (“<code class="docutils literal notranslate"><span class="pre">h</span></code>”). The rest of the flags line looks like</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>diffusivity (dt=0.83945 in 2 substeps; av dt_sub_mass_cont=0.41972)
</pre></div>
</div>
<p>Recall that the PISM time step is determined by an adaptive mechanism. Stable mass
conservation and conservation of energy solutions require such an adaptive time-stepping
scheme <a class="bibtex reference internal" href="../../zzz_references_html.html#bbl" id="id1">[26]</a>. The first character we see here, namely “<code class="docutils literal notranslate"><span class="pre">diffusivity</span></code>”, is the
adaptive-timestepping “reason” flag. See <a class="reference internal" href="#tab-adaptiveflag"><span class="std std-numref">Table 35</span></a>. We also see
that there was a major time step of <span class="math notranslate nohighlight">\(0.83945\)</span> model years divided into <span class="math notranslate nohighlight">\(2\)</span>
substeps of about <span class="math notranslate nohighlight">\(0.42\)</span> years. The <code class="option docutils literal notranslate"><span class="pre">-skip</span></code> option enables this mechanism,
while <code class="option docutils literal notranslate"><span class="pre">-skip_max</span></code> sets the maximum number of such substeps. The adaptive mechanism
may choose to take fewer substeps than <code class="docutils literal notranslate"><span class="pre">-skip_max</span></code> so as to satisfy certain numerical
stability criteria, however.</p>
<p>The second line in the above, the line which starts with “<code class="docutils literal notranslate"><span class="pre">S</span></code>”, is the summary. Its
format, and the units for these numbers, is simple and is given by a couple of lines
printed near the beginning of the standard output for the run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>P       YEAR:       ivol      iarea  max_diffusivity  max_hor_vel
U      years   10^6_km^3  10^6_km^2         m^2 s^-1       m/year
</pre></div>
</div>
<p>That is, in each summary we have the total ice volume, total ice area, maximum diffusivity
(of the SIA mass conservation equation), and maximum horizontal velocity (i.e.
<span class="math notranslate nohighlight">\(\max(\max(|u|), \max(|v|))\)</span>).</p>
<p>The third line of the above example shows that the SSA stress balance was solved.
Information on the number of nonlinear (outer) and linear (inner) iterations is provided
<a class="bibtex reference internal" href="../../zzz_references_html.html#bbssasliding" id="id2">[25]</a>.</p>
<table class="colwidths-given docutils align-default" id="tab-adaptiveflag">
<caption><span class="caption-number">Table 35 </span><span class="caption-text">Meaning of the adaptive time-stepping “reason” flag in the standard output
             flag line.</span><a class="headerlink" href="#tab-adaptiveflag" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>PISM output</p></th>
<th class="head"><p>Active adaptive constraint or PISM sub-system that limited time-step size</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">3D</span> <span class="pre">CFL</span></code></p></td>
<td><p>three-dimensional CFL for temperature/age advection <a class="bibtex reference internal" href="../../zzz_references_html.html#bbl" id="id3">[26]</a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">diffusivity</span></code></p></td>
<td><p>diffusivity for SIA mass conservation <a class="bibtex reference internal" href="../../zzz_references_html.html#bbl" id="id4">[26]</a>, <a class="bibtex reference internal" href="../../zzz_references_html.html#hindmarshpayne" id="id5">[107]</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">end</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">run</span></code></p></td>
<td><p>end of prescribed run time</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">max</span></code></p></td>
<td><p>maximum allowed <span class="math notranslate nohighlight">\(\Delta t\)</span> applies; set with <code class="docutils literal notranslate"><span class="pre">-max_dt</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">internal</span> <span class="pre">(derived</span> <span class="pre">class)</span></code></p></td>
<td><p>maximum <span class="math notranslate nohighlight">\(\Delta t\)</span> was temporarily set by a derived class</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">2D</span> <span class="pre">CFL</span></code></p></td>
<td><p>2D CFL for mass conservation in SSA regions (upwinded; <a class="bibtex reference internal" href="../../zzz_references_html.html#bbssasliding" id="id6">[25]</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-ts_...</span> <span class="pre">reporting</span></code></p></td>
<td><p>the <code class="docutils literal notranslate"><span class="pre">-ts_times</span></code> option and the configuration flag
<a class="reference internal" href="../parameters/index.html#config-time_stepping.hit_ts_times"><code class="docutils literal notranslate"><span class="pre">time_stepping</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.hit_ts_times</span></code></a>; see section <a class="reference internal" href="saving-time-series.html#sec-saving-time-series"><span class="std std-ref">Saving time series of scalar diagnostic quantities</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-extra_...</span> <span class="pre">reporting</span></code></p></td>
<td><p>the <code class="docutils literal notranslate"><span class="pre">-extra_times</span></code> option; see section <a class="reference internal" href="saving-diagnostics.html#sec-saving-diagnostics"><span class="std std-ref">Saving time series of spatially-varying diagnostic quantities</span></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">surface</span></code></p></td>
<td><p>a surface or an atmosphere model</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ocean</span></code></p></td>
<td><p>an ocean model</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hydrology</span></code></p></td>
<td><p>a hydrology model stability criterion, see section <a class="reference internal" href="../modeling-choices/subglacier/hydrology.html#sec-subhydro"><span class="std std-ref">Subglacial hydrology</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">BTU</span></code></p></td>
<td><p>time-the bedrock thermal layer model, see section <a class="reference internal" href="../modeling-choices/dynamics/energy-balance.html#sec-energy"><span class="std std-ref">Modeling conservation of energy</span></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">eigencalving</span></code></p></td>
<td><p>the eigen-calving model, see section <a class="reference internal" href="../modeling-choices/marine/calving.html#sec-calving"><span class="std std-ref">Calving and front retreat</span></a></p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="tab-time-stepping">
<caption><span class="caption-number">Table 36 </span><span class="caption-text">Options controlling time-stepping</span><a class="headerlink" href="#tab-time-stepping" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 38%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="option docutils literal notranslate"><span class="pre">-adapt_ratio</span></code></p></td>
<td><p>Adaptive time stepping ratio for the explicit scheme for the mass balance equation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="option docutils literal notranslate"><span class="pre">-max_dt</span></code> (years)</p></td>
<td><p>The maximum time-step in years. The adaptive time-stepping scheme will make the
time-step shorter than this as needed for stability, but not longer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="option docutils literal notranslate"><span class="pre">-skip</span></code></p></td>
<td><p>Enables time-step skipping, see below.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="option docutils literal notranslate"><span class="pre">-skip_max</span></code></p></td>
<td><p>Number of mass-balance steps, including SIA diffusivity updates, to perform before
temperature, age, and SSA stress balance computations are done. This is only
effective if the time step is being limited by the diffusivity time step
restriction associated to mass continuity using the SIA. The maximum recommended
value for <code class="docutils literal notranslate"><span class="pre">-skip_max</span></code> is, unfortunately, dependent on the context. The
temperature field should be updated when the surface changes significantly, and
likewise the basal sliding velocity if it comes (as it should) from the SSA
calculation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="option docutils literal notranslate"><span class="pre">-timestep_hit_multiples</span></code> (years)</p></td>
<td><p>Hit multiples of the number of model years specified. For example, if stability
criteria require a time-step of 11 years and the <code class="docutils literal notranslate"><span class="pre">-timestep_hit_multiples</span> <span class="pre">3</span></code>
option is set, PISM will take a 9 model year long time step. This can be useful to
enforce consistent sampling of periodic climate data.</p></td>
</tr>
</tbody>
</table>
</div>


      <hr>
      <table style="width: 100%">
        <tr>
          <td style="text-align: left; width: 30%">
              <a class="reference internal" href="signals.html">Previous</a>
          </td>
          <td style="text-align: center; width: 30%">
              <a class="reference internal" href="index.html">Up</a>
          </td>
          <td style="text-align: right; width: 30%">
              <a class="reference internal" href="mass-conservation.html">Next</a>
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/pism-logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installing PISM</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">PISM User’s Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../std-greenland/index.html">Getting started: a Greenland ice sheet example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../highlevelview/index.html">Ice dynamics, the PISM view</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initialization/index.html">Initialization and bootstrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modeling-choices/index.html">Modeling choices</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Practical usage</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="netcdf-tools.html">Handling NetCDF files</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-output.html">Input and output</a></li>
<li class="toctree-l3"><a class="reference internal" href="saving-time-series.html">Saving time series of scalar diagnostic quantities</a></li>
<li class="toctree-l3"><a class="reference internal" href="saving-diagnostics.html">Saving time series of spatially-varying diagnostic quantities</a></li>
<li class="toctree-l3"><a class="reference internal" href="saving-snapshots.html">Saving re-startable snapshots of the model state</a></li>
<li class="toctree-l3"><a class="reference internal" href="diagnostic-viewers.html">Run-time diagnostic viewers</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters.html">PISM’s configuration parameters and how to change them</a></li>
<li class="toctree-l3"><a class="reference internal" href="regridding.html">Regridding</a></li>
<li class="toctree-l3"><a class="reference internal" href="signals.html">Signals, to control a running PISM model</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Understanding adaptive time-stepping</a></li>
<li class="toctree-l3"><a class="reference internal" href="mass-conservation.html">Balancing the books</a></li>
<li class="toctree-l3"><a class="reference internal" href="petsc-options.html">PETSc options for PISM users</a></li>
<li class="toctree-l3"><a class="reference internal" href="scripts.html">Utility and test scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="flowline.html">Using PISM for flow-line modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="modifying-pism.html">Managing source code modifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="ismip6.html">ISMIP6 Greenland</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../simplified-geometry/index.html">Simplified geometry experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../verification/index.html">Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../validation/index.html">Validation case studies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jakobshavn/index.html">Example: A regional model of the Jakobshavn outlet glacier in Greenland</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parameters/index.html">Configuration parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diagnostics/index.html">Diagnostic quantities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../climate_forcing/index.html">Climate forcing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical/index.html">Technical notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing to PISM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authorship.html">Authorship</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zzz_references_html.html">References</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      Git revision v1.0-1840-g248f66242
      committed by Constantine Khrulev
      on 2020-09-02 09:56:04 -0800 |
      &copy; 2004--2020, the PISM authors.
      
    </div>
  </body>
</html>